addpath('libQuaternion');
close all;
clear all;
clc;
pkg load signal;

% Load Sensor Data
%{
LinearAcc_x = [2.0367818 2.305459 2.13759 1.8903451 1.7689843 1.9802313 1.8228707 1.7812548 1.6818137 1.6127615 1.8058271 1.756495 1.5334225 1.6508708 1.5284972 1.8431206 1.6804361 1.8112216 1.5926247 1.3792009 1.2687387 1.2108088 1.1441555 1.0508175 1.0448132 1.1870289 0.78759 0.5415449 0.58007526 0.64101315 0.3720703 0.33331108 0.57874393 0.7006626 0.38715172 0.2400589 0.50284386 0.5051327 0.40512943 0.5788126 0.76145935 0.35673237 0.7205696 0.6455269 0.51179504 0.31836224 0.049723625 0.1424427 0.4575281 0.31684685 0.3279152 0.4994135 0.48875427 0.31750393 0.30444813 0.21562862 0.27936077 0.19766808 0.21111107 0.2335186 0.29102135 0.31551456 0.24540234 0.3320017 0.16709232 0.09105396 0.2535286 0.3058443 0.1199646 0.41807842 0.41016293 0.5995798 0.5603514 0.86785126 1.7762108 3.3097258 2.5600777 2.2226114 2.6780796 2.2056894 1.4815531 -0.58993435 -2.0235062 -2.4478035 -3.112246 -5.1119576 -7.628875 -9.243662 -13.425955 -11.4371605 -11.453732 -3.9987435 3.895008 5.689742 8.470147 8.642834 8.9313345 7.172471 2.8385181 -1.0912743 -3.1598449 -5.401456 -6.748954 -7.908007 -5.440204 -3.2255492 -2.1775184 1.4038963 4.588336 3.91008 5.0226355 7.090102 8.785154 9.854594 11.525493 8.701961 3.7503424 -1.1610737 -4.959141 -8.037428 -12.672986 -15.704792 -15.651939 -14.191585 -10.280757 -11.16623 -15.880707 -18.014328 -16.711914 -8.424399 2.5045738 8.3481045 9.28071 12.635597 13.628492 10.646001 10.5889015 10.509678 11.5569725 12.234997 5.0268807 -1.1499739 -12.62299 -16.797672 -20.877922 -7.1359773 -4.140764 -1.9140806 -0.34677887 2.1588087 2.404151 2.718173 1.2249537 0.20793724 -0.25152302 -0.17967987 -0.16664124 -0.018852234 -0.18585205 -0.09281254 -0.14129925 0.0020980835 0.0260849 -0.32231522 -0.31515503 -0.12766361 0.08420372 -0.12757874 -0.059176445 -0.22000122 -0.3804531 
];
LinearAcc_y = [-3.2488992 -3.491189 -3.428158 -3.1783547 -3.0250692 -3.2422676 -3.1313186 -3.0648565 -2.8855171 -2.9740891 -3.0544753 -2.9265163 -2.6968074 -2.7105353 -2.7840722 -2.9662704 -2.7240376 -3.0073671 -2.9705896 -2.6817026 -2.6088789 -2.614965 -2.5420642 -2.440436 -2.3558052 -2.461083 -1.905587 -1.7365422 -1.673003 -1.6106322 -1.517488 -1.4342048 -1.543437 -1.6410601 -1.2827361 -1.3222055 -1.3674228 -1.4131749 -1.097132 -1.4632788 -1.5591834 -1.234235 -1.342648 -1.4833934 -1.214145 -1.0969388 -0.9041054 -0.87353253 -1.2555506 -1.1789455 -1.0631745 -1.1209028 -1.2602565 -0.9603605 -0.86289 -0.8364837 -0.84085894 -0.5515106 -0.6726451 -0.72786 -0.63461566 -0.72984934 -0.5225506 -0.571542 -0.42765856 -0.2972257 -0.34665847 -0.29467487 -0.2856009 -0.2852919 -0.53377295 -0.4524355 -0.36467242 -0.56537247 -0.39640594 0.2758019 -0.39753175 -1.1176763 -1.4808056 -1.6985464 -1.9583461 -1.0804653 -0.38994694 -0.82124853 -0.92192125 -0.07766104 1.3817091 2.7253113 1.940207 -4.9681454 -6.614063 -11.932866 -13.6033325 -10.804478 -7.5380964 -6.6957736 -6.6785407 -6.6395855 -6.485683 -10.279822 -9.924749 -8.443523 -8.231396 -6.8507705 -5.3815966 -3.028572 -0.36050868 -0.08269501 0.521158 2.3538725 2.5053506 1.1941452 1.2502204 0.988253 -2.9923773 -7.0983763 -7.7531915 -10.315419 -11.784949 -9.562425 -6.326007 -1.6608161 -0.40460348 -1.4850029 -4.1078615 -3.9195166 -1.5393653 -0.3824072 -1.8000494 -7.3300533 -10.655958 -6.5297127 -5.640862 -2.5351772 -1.6807146 -1.6774673 -1.9559469 -4.091054 -3.6176376 -2.8341055 -10.158146 -12.0604925 -8.457119 -5.10296 1.5279951 -0.6909034 -0.6053963 -0.5935619 -0.5925579 -0.5545857 -0.6646819 -1.2186052 -0.33393908 0.14757657 0.5213468 0.056858063 -0.047322273 0.022722006 -0.48274255 -0.16044545 -0.32231236 -0.30337167 -0.11126423 0.067129135 0.22601008 0.07534313 -0.06403756 0.0126440525 -0.13475847 -0.023997068 0.20682764 
];
LinearAcc_z = [3.3945546 3.4165761 3.51054 3.2326703 2.7007906 3.4454982 3.3504283 2.864026 2.3669055 3.253058 3.2068672 2.980585 2.2570536 3.0189464 3.13584 2.8338287 2.1600375 2.7492917 2.81894 2.6420975 2.4406385 2.4955783 2.278535 1.5266962 2.3367383 2.1147232 1.6405945 1.7724016 1.65859 1.3874837 1.0832376 1.3606925 1.5393641 1.437184 0.994732 1.1074569 1.4651401 1.1871114 1.2697009 1.098845 1.3780059 1.7945735 1.0527714 1.7805474 1.3675486 1.2948405 1.0808928 1.0210813 0.9929856 0.9474798 0.59693325 0.79275805 0.95477057 0.7456362 0.6621127 0.50747335 0.57504725 0.43687654 0.66509354 0.57751226 0.53992426 0.68673044 0.40300354 0.19858158 0.28112778 0.6577943 0.5682295 0.3166077 0.20456067 0.43737835 0.051843166 -0.067876816 0.38551608 -0.021369338 -0.7053409 -0.06260347 0.48714566 -0.19532526 -1.1613238 -1.8951607 -1.0807445 -0.2261349 0.3760985 3.494563 3.6608987 3.7577772 7.0345926 10.465193 11.28814 16.412676 11.337503 2.873803 -2.475078 -6.030972 -8.524458 -10.2772455 -9.536485 -7.364683 -8.302704 -11.843274 -10.85379 -9.866034 -7.985494 0.647787 8.094971 12.387143 15.250856 19.137438 19.646463 12.778531 9.936507 12.683174 16.676943 13.043741 11.64314 12.961348 9.185466 1.0323565 -3.4210978 -3.8669224 -5.5892506 -7.9491177 -6.3293405 -2.51476 1.3860173 3.1291456 5.8387723 5.435023 4.2400637 4.7835975 3.8114371 12.522452 9.355079 4.261483 3.3424568 1.983629 -0.11142054 -2.9987183 -4.3556414 -4.381932 3.0430195 9.113916 10.352805 8.061636 6.341984 5.5089693 2.0594797 0.86672974 0.6852007 0.57945275 0.50179625 -0.086740255 1.3327435 1.8862914 2.049368 1.3384938 1.2478929 1.395706 -0.03191054 0.122635126 -0.30496132 -0.042473435 0.094388604 -0.1433816 0.02856052 0.1621381 0.30342495 0.09794736 0.1292857 0.038219213 -0.44825888 
];
Gyro_x =  [-2.7482426 3.969684 8.061512 -0.9771529 -5.9239893 1.5268015 4.763621 -0.4275044 -6.5347104 -3.4200351 3.236819 2.3818104 -12.4587 -7.450791 -7.939368 -2.8703866 -13.252637 -7.634007 0.12214411 -1.4657294 -7.206503 2.6260986 3.6032515 -5.1300526 -5.2521973 0.12214411 -5.374341 -2.7482426 1.5268015 1.2825131 -3.4811072 -2.992531 2.7482426 4.213972 -2.5039544 -3.175747 1.1603692 2.992531 -5.2521973 -11.115115 6.5347104 3.4811072 -3.175747 -3.7253954 3.6643236 4.091828 -5.374341 -6.1682777 -4.030756 -2.9314587 0.0 3.5421793 0.3053603 2.5039544 2.0764499 -0.3053603 -0.8550088 -1.7100176 1.0382249 -0.3053603 -2.8703866 -3.6643236 -2.0764499 -2.5039544 -3.6032515 -7.939368 -3.4200351 -1.5878735 -4.9468365 -3.2978911 -2.992531 -1.8932338 -0.7328647 -9.6493845 -18.99341 -0.061072055 -2.8093145 -14.596222 -40.12434 -37.620388 -41.956505 -46.29262 -47.330845 -11.725835 -14.901582 -28.154219 22.902021 80.61512 122.69376 281.84753 290.94727 200.866 167.52066 156.8941 100.219246 37.3761 6.656854 12.641915 -13.130492 -160.68057 -213.99649 -260.1059 -346.09537 -364.60016 -318.42972 -285.3897 -260.3502 -162.94025 -23.024166 -22.596663 -13.313708 87.82162 129.10632 144.13005 181.26187 230.54701 220.1037 163.73419 124.15949 109.86863 80.61512 38.84183 31.329964 27.115995 -17.405537 -15.206943 15.14587 32.001755 39.330406 61.438488 -2.8093145 -43.727592 -59.239895 -4.091828 -3.6032515 -25.467049 -32.490334 -31.635328 -76.64543 -84.27944 -136.8014 -118.907295 -108.341835 -99.36424 -56.491653 3.114675 11.359403 5.8629174 4.3361163 12.764061 3.114675 -6.778999 0.7328647 -1.5878735 -8.855449 -4.7025485 -1.8321618 2.4428823 0.8550088 0.18321617 -1.3435853 2.3818104 4.8857646 1.8321618 -0.8550088 1.4046572 4.9468365 3.053603 0.24428822 1.0992969 1.5268015 
];
Gyro_y =  [-9.099736 7.1454306 16.30624 1.0382249 -11.054042 0.36643234 11.970124 2.3818104 -18.68805 -0.18321617 10.931898 11.542619 -21.253077 -0.54964846 14.535151 19.176624 -20.703428 -14.413006 9.038664 9.832602 -13.6801405 2.7482426 11.970124 -14.107645 -6.656854 7.0843587 -12.397628 -9.160809 3.4200351 1.7100176 -8.916521 -4.5804043 11.6647625 13.924429 -8.855449 1.6489456 4.8857646 8.672233 -11.481546 -13.008348 3.6643236 12.275483 -11.909052 -9.527242 0.48857644 -2.8703866 -23.085238 -16.489454 -10.748682 -5.374341 3.4811072 17.649824 17.649824 12.886204 4.030756 1.6489456 4.5804043 2.5039544 3.114675 -1.4046572 -8.794375 1.1603692 6.351494 -0.3053603 -4.3361163 -4.519332 -1.2214411 -10.809754 -12.764061 -7.450791 -21.192005 -24.978472 -5.5575576 -11.6647625 -22.596663 -28.52065 -32.67355 -44.82689 -62.171352 -43.91081 -24.550966 -13.985501 -29.68102 17.039104 22.53559 -20.642357 14.22979 56.613796 79.14938 71.087875 72.18717 -0.6107206 -48.307995 18.74912 13.374781 -22.291302 -26.871706 50.99517 41.956505 48.552288 105.3493 120.98375 118.663 114.38796 131.30493 50.50659 -0.6717926 8.183656 36.093586 -35.666084 -49.529438 -6.107206 -24.184534 -91.7913 -133.38138 -135.88533 -172.95607 -205.32426 -145.47363 -114.99869 -46.23155 -36.093586 -15.756592 19.726273 39.941124 96.12742 113.22759 111.21221 174.84929 266.64063 219.18762 75.423996 20.7645 71.759674 42.322937 -14.535151 -15.512302 -27.60457 -79.21046 -75.11863 -93.19596 -76.401146 -95.69991 -29.009228 6.107206 21.06986 28.337435 15.573374 13.435853 21.98594 13.802285 18.260546 25.711336 8.427944 -18.077328 -11.786907 -6.656854 1.5878735 -5.9239893 1.9543058 3.7864676 6.7179265 4.7025485 -1.8321618 -3.2978911 2.3818104 1.4657294 -5.435413 -6.0461335 -3.4200351 -0.48857644 
];
Gyro_z = [0.24428822 -3.053603 -3.175747 0.0 0.24428822 -1.2214411 -0.54964846 -1.3435853 -1.3435853 0.0 -1.8321618 -2.259666 -4.091828 -2.1985939 -1.6489456 -3.4811072 -5.618629 -6.9622145 -3.3589633 -1.2825131 -3.9086115 -0.8550088 -2.137522 -3.175747 -3.6643236 -5.1300526 -2.015378 -1.2825131 0.7939367 -2.3818104 0.4275044 2.8093145 -0.3053603 -1.8932338 -1.6489456 0.3053603 -0.3053603 -1.6489456 0.9160809 1.5878735 4.1528997 6.5957823 0.18321617 -0.4275044 -0.48857644 -0.061072055 5.1300526 3.6643236 0.12214411 -0.7328647 -0.48857644 -4.5804043 -2.9314587 -3.2978911 -3.7864676 -4.213972 -3.053603 -0.48857644 0.48857644 -2.3818104 -2.6871705 -3.5421793 -5.5575576 -8.855449 -10.931898 -7.1454306 -7.389719 -9.6493845 -11.054042 -11.847979 -10.260105 -13.557998 -9.405097 -9.038664 -12.641915 -31.20782 -32.490334 -36.82645 -62.354572 -80.187614 -87.82162 -84.89016 -72.67575 -60.949913 -45.559757 -15.939806 58.873463 100.219246 157.01627 298.8256 339.49957 321.66653 243.98286 170.6964 77.07293 54.781635 15.084798 -30.108524 -31.635328 -59.239895 -71.33217 -65.40818 -53.743412 -15.14587 -4.3971877 16.733744 41.529 41.773285 16.000877 3.236819 -21.37522 -54.720562 -76.03471 -107.05931 -165.13885 -187.308 -185.59798 -190.48373 -196.7131 -182.11687 -138.63358 -80.4319 -44.704746 -2.9314587 58.75132 94.53954 180.22365 244.96004 330.46088 393.12085 308.65817 210.6986 187.49123 69.62215 36.337875 32.30712 -5.374341 -68.09534 -151.21442 -242.02856 -391.47186 -408.02243 -371.74564 -226.94377 -147.7333 10.260105 19.481987 21.619509 18.260546 6.7179265 6.5957823 -14.107645 -15.390158 -11.970124 -5.191125 -2.0764499 1.0992969 2.6260986 -0.9160809 -1.4046572 -0.061072055 -1.4046572 -2.0764499 -0.54964846 1.9543058 1.9543058 0.3053603 -1.7710897 -2.6871705 -2.1985939 1.8932338 
];
Magnetic_x =   [13.601685,  13.236237,  13.845825,  14.1506195,  14.187317,  14.5772295,  14.646912,  14.607811,  14.790726,  14.97364,  15.065002,  15.065002,  15.065002,  15.065002,  15.339088,  15.613174,  15.613174,  15.795898,  15.795898,  15.88726,  16.069984,  15.88726,  15.795898,  15.43026,  15.43026,  15.43026,  15.155983,  14.881706,  14.881706,  14.6987915,  14.5160675,  14.5160675,  14.241791,  13.510513,  13.327789,  13.145065,  12.50515,  12.322426,  11.956787,  11.774063,  11.956978,  12.322617,  12.688255,  13.145256,  13.8765335,  14.607811,  15.247536,  15.43026,  15.43026,  14.973259,  13.693619,  11.682701,  8.940506,  5.3756714,  1.1711121,  -3.125,  -7.9696655,  -12.81414,  -17.110252,  -20.583725,  -24.057198,  -26.616669,  -28.627586,  -29.63295,  -30.729866,  -30.821419,  -30.638695,  -30.181694,  -28.3535,  -26.159668,  -23.051834,  -19.761276,  -15.282249,  -10.346222,  -5.1361084,  0.43964386,  5.6497574,  10.40287,  14.6074295,  17.715263,  19.634819,  20.183182,  19.360542,  16.618347,  12.139511,  6.746483,  0.89645386,  -4.6792984,  -10.346603,  -16.013718,  -20.949554,  -24.697113,  -26.799393,  -27.98767,  -28.718758,  -28.901672,  -28.170395,  -26.433754,  -24.697113,  -22.86892,  -21.040916,  -19.212723,  -17.293358,  -15.556526,  -14.002609,  -12.448692,  -10.803413,  -8.97541,  -7.147217,  -5.227661,  -3.2165527,  -1.3883591,  0.4398346,  2.0851135,  3.7303925,  4.9186707,  6.106949,  7.2036743,  7.752037,  8.483124,  8.8487625,  9.214401,  9.397316,  9.762955,  9.854317,  9.854317,  10.037041,  9.671402,  9.945488,  9.945488,  9.945488,  10.03685];
Magnetic_y =   [-36.514282,  -36.148834,  -36.02702,  -36.514664,  -36.36841,  -36.51479,  -36.514717,  -36.33194,  -36.240578,  -36.149216,  -36.33213,  -36.057854,  -35.96649,  -35.600853,  -35.50949,  -35.783768,  -36.058044,  -36.33232,  -36.33232,  -36.515236,  -36.880875,  -37.5206,  -37.88624,  -38.068962,  -38.34305,  -38.525772,  -38.982773,  -39.074135,  -39.074135,  -38.982773,  -39.165497,  -39.165497,  -39.34841,  -39.62269,  -39.71405,  -40.353775,  -40.9935,  -41.9075,  -42.456055,  -43.46161,  -44.101524,  -45.19825,  -45.929527,  -46.569443,  -46.93508,  -46.93508,  -46.93508,  -46.295166,  -45.65525,  -44.649887,  -43.644333,  -42.364693,  -41.176414,  -39.988136,  -39.25686,  -38.89122,  -38.89122,  -38.89122,  -39.074135,  -39.622498,  -40.0795,  -40.62805,  -40.810776,  -41.085052,  -40.810776,  -40.902138,  -41.267776,  -41.45069,  -42.27352,  -43.187523,  -44.101715,  -45.10708,  -46.47827,  -47.575188,  -48.671913,  -49.494553,  -49.951553,  -49.76883,  -49.76883,  -49.03755,  -47.574997,  -45.65544,  -43.4618,  -41.450882,  -38.89141,  -36.240578,  -33.315468,  -31.030464,  -29.293823,  -27.739906,  -26.460266,  -25.911713,  -26.094627,  -27.46563,  -29.293823,  -31.30474,  -34.138298,  -37.428856,  -40.445137,  -43.278694,  -46.02089,  -48.12336,  -50.22564,  -51.87092,  -52.78492,  -53.516197,  -54.247475,  -54.704666,  -55.25303,  -55.80139,  -55.984306,  -56.258583,  -56.62422,  -56.62422,  -56.62422,  -56.62422,  -56.258583,  -55.892944,  -55.618668,  -55.34439,  -54.978752,  -54.52175,  -54.06475,  -53.790474,  -53.60775,  -53.516388,  -53.333664,  -52.876663,  -52.602386,  -52.7853,  -53.059578,  -52.876663];
Magnetic_z = [-32.0755,-32.0755,-32.310993,-32.07512,-31.933594,-31.839243,-31.569563,-31.455803,-31.632614,-31.897926,-31.721115,-32.07493,-32.34024,-32.25174,-32.42874,-32.34024,-31.809425,-31.367111,-31.27861,-30.747795,-30.393982,-30.21698,-29.862976,-29.862976,-29.951477,-29.774475,-29.597473,-29.685974,-29.597473,-29.685974,-29.774475,-29.862976,-29.774475,-30.128479,-30.305481,-30.393982,-30.482483,-30.393982,-30.21698,-29.862976,-29.774475,-29.154968,-28.800964,-28.712463,-28.712463,-28.889465,-29.774284,-30.924606,-32.07493,-33.667564,-35.437202,-37.02984,-38.799286,-40.568733,-41.630554,-41.895866,-41.541862,-40.21473,-37.825775,-34.906006,-31.543922,-27.474022,-22.873116,-18.183899,-13.583183,-9.424782,-5.3548813,-1.2849808,3.138733,7.2971344,11.101532,14.1981125,16.498566,18.179512,18.621826,17.737198,15.525436,11.89785,6.9431305,0.9267807,-5.620575,-12.521744,-19.334412,-25.350952,-30.924988,-35.26039,-38.533974,-40.391922,-40.30342,-39.1531,-37.914467,-36.764145,-35.34851,-34.19819,-33.047867,-31.809235,-31.101418,-30.482101,-29.154968,-27.120018,-24.465752,-21.457672,-18.27259,-15.795326,-13.760376,-11.813927,-9.955788,-8.451653,-7.3015213,-6.5052032,-6.15139,-5.443573,-4.824257,-4.3819427,-4.5589447,-5.0014496,-5.7977676,-6.5940857,-7.301903,-8.09803,-8.982658,-10.13279,-10.752106,-11.19442,-11.725235,-12.167549,-12.875366,-13.583183,-14.025688,-14.20269,-14.733505,-14.999008];
Gravity_x = [7.3780236 7.364277 7.3747067 7.4894505 7.4836373 7.4745955 7.478415 7.671741 7.6515427 7.6298304 7.6332197 7.8091516 7.882787 7.84744 7.855304 7.8798084 7.877593 7.908669 7.9569035 8.164827 8.118214 8.102064 8.286931 8.284895 8.262361 8.247477 8.532959 8.624874 8.717761 8.80926 8.804416 8.798136 8.802549 8.81113 8.865469 8.8621025 8.864666 8.870457 8.911823 8.904073 8.899366 8.919955 8.928832 8.945442 9.001945 9.056898 9.086899 9.081629 9.075743 9.084794 9.126479 9.160078 9.164254 9.164099 9.162384 9.189261 9.214816 9.236103 9.253454 9.26261 9.281564 9.299524 9.315973 9.308061 9.298032 9.276065 9.271603 9.264439 9.252048 9.239191 9.215511 9.189029 9.176125 9.1713085 9.145018 9.096152 9.020945 8.928483 8.797734 8.604087 8.368491 8.121227 7.8676367 7.434717 7.257711 7.149196 7.175725 7.4106855 7.861044 9.069202 9.52261 9.646194 9.413124 9.103257 8.873775 8.711118 8.617416 8.625185 8.721088 8.92123 9.082992 9.2471485 9.379923 9.469138 9.506464 9.519395 9.4955435 9.441321 9.4061985 9.39497 9.385387 9.419868 9.491889 9.569622 9.626161 9.623915 9.493462 9.1710615 8.695714 8.223878 7.817213 7.549736 7.384278 7.3526154 7.5501637 7.8227334 8.2468605 8.641595 8.952141 8.680165 7.8111763 6.9166017 6.1027656 5.4873977 5.250699 5.082843 4.995982 5.267298 5.6221514 6.345244 8.278797 8.993663 9.270241 9.13246 8.93449 8.566069 8.642872 8.720037 8.780684 8.828107 8.867589 8.896666 8.907936 8.918654 8.898401 8.866126 8.84813 9.152049 9.150645 9.133739 9.13544 9.140842 9.142932 9.140824 9.138936 9.141363 9.146918 9.14336 9.133548 9.12494 9.120845 
];
Gravity_y = [5.3773756 5.3831515 5.385068 5.3061714 5.3104014 5.316125 5.314475 5.1618586 5.173932 5.186142 5.1909523 5.050331 4.9911633 5.026503 5.044058 5.0638885 5.0891857 5.0576196 5.016532 4.818694 4.864623 4.8793063 4.679385 4.689301 4.7096004 4.732404 4.415691 4.285922 4.151633 4.0155764 4.0231447 4.0215654 4.012733 4.015249 3.9336202 3.9358895 3.9352837 3.9371245 3.8703783 3.8706875 3.8681717 3.8355837 3.8153753 3.7771492 3.6714482 3.5707462 3.5090308 3.4926047 3.487019 3.4600995 3.3688645 3.3010304 3.3190093 3.3370116 3.352443 3.2962523 3.24251 3.198825 3.1610093 3.140649 3.08977 3.041612 3.006899 3.0366664 3.0685236 3.1368046 3.1540568 3.1746495 3.2050195 3.239604 3.295806 3.3485982 3.3705432 3.3807266 3.4382133 3.5390902 3.688866 3.8565524 4.0817413 4.4116488 4.822164 5.2423544 5.631833 6.2049503 6.438062 6.574933 6.547619 6.2747917 5.688001 3.2455108 1.4444702 -0.4791557 -2.151689 -3.3009453 -4.021327 -4.4127073 -4.580272 -4.562797 -4.4272375 -4.0046496 -3.6170964 -3.2014 -2.813886 -2.5092146 -2.387681 -2.3548176 -2.4387589 -2.598671 -2.7180617 -2.7702794 -2.7459757 -2.586679 -2.3389041 -1.9884528 -1.4070752 -0.67526394 0.0066527356 0.62769264 1.2291367 1.7873487 2.1937761 2.4932222 2.6290674 2.6372085 2.3752985 2.13322 1.633689 0.6858178 -0.70037526 -4.347083 -5.9243884 -6.93974 -7.66414 -8.118582 -8.26529 -8.368025 -8.430297 -8.27079 -8.03359 -7.440527 -4.9215236 -2.976395 -0.9202797 0.83766717 2.0166423 3.3326867 3.2503457 3.142763 3.0340168 2.9606738 2.9141765 2.9148943 2.9941301 3.0624733 3.1088898 3.1371846 3.150077 3.0941808 3.0898159 3.111604 3.1125607 3.1073546 3.1134348 3.1189547 3.117866 3.1087747 3.1003218 3.0938525 3.103413 3.1150258 3.1158853 
];
Gravity_z = [-3.5803618 -3.5999262 -3.5756283 -3.4529736 -3.4590724 -3.4698205 -3.4641068 -3.2664967 -3.294645 -3.3256552 -3.3103383 -3.1115334 -3.0199916 -3.053252 -3.0036771 -2.9044843 -2.8660254 -2.8361604 -2.7735267 -2.5072212 -2.5691316 -2.5921643 -2.366538 -2.3540087 -2.392375 -2.3987212 -1.9648527 -1.8473737 -1.7131772 -1.562843 -1.5706393 -1.6094077 -1.6073176 -1.5531138 -1.4492931 -1.4636585 -1.4497051 -1.4086914 -1.3303939 -1.3804507 -1.4173527 -1.3758876 -1.3744977 -1.3720666 -1.286795 -1.1801499 -1.1337433 -1.2231535 -1.2813915 -1.2901928 -1.2363243 -1.1690025 -1.0821339 -1.0266706 -0.99107003 -0.92876285 -0.86237466 -0.7951719 -0.742946 -0.7146765 -0.69010437 -0.66170096 -0.5844278 -0.55594224 -0.548774 -0.53427374 -0.5096102 -0.5120239 -0.5457383 -0.55920446 -0.6183946 -0.72041476 -0.78008014 -0.7925424 -0.847175 -0.9514426 -1.0886693 -1.2568127 -1.4524488 -1.6362764 -1.6986642 -1.6534096 -1.5978472 -1.5472314 -1.430858 -1.3526485 -1.3446394 -1.3707982 -1.4216151 -1.8402748 -1.8449415 -1.7005068 -1.7128048 -1.5507622 -1.1204568 -0.90267074 -0.96519494 -0.97848797 -0.7159308 -0.7381127 -0.76567286 -0.6416247 -0.5190908 -0.457839 -0.31064093 -0.07946487 -0.23972704 -0.5279457 -0.5531246 -0.48008242 -0.7379098 -0.86344755 -0.77713585 -0.799227 -1.2359399 -1.7591712 -2.4585593 -3.4158456 -4.3639584 -5.034242 -5.4998984 -5.7407084 -5.8932877 -5.929125 -5.789936 -5.5158477 -5.0488353 -4.58507 -3.9419584 -1.3885168 -0.23981647 0.41353592 0.4330898 0.38403034 0.53431976 0.557915 0.37501928 0.1413474 -0.1523476 -0.73947865 -1.8467544 -2.5348535 -3.0636764 -3.4737384 -3.5040565 -3.418486 -3.3024824 -3.2022405 -3.1408122 -3.0772243 -3.007293 -2.9194386 -2.8025362 -2.692442 -2.7062206 -2.778539 -2.8209913 -1.6841671 -1.6997396 -1.7501825 -1.7395535 -1.7203838 -1.6981483 -1.6993625 -1.7114822 -1.7150371 -1.7006586 -1.7313144 -1.7656416 -1.7895424 -1.808819 
];
%}

%{
LinearAcc_x =[0.5310173 0.4802742 0.35438347 0.5043068 0.5332842 0.46394157 0.058102608 0.63543797 0.5113945 0.223382 0.38995457 0.35741043 0.20793247 0.09912491 0.12637997 0.23152447 0.20196533 -0.042606354 -0.5108013 -0.18302631 0.5429926 0.36105728 -0.4546461 -0.59318066 0.44612885 0.36330128 -0.11955738 0.043626785 0.03871441 -0.028912544 -0.28900242 -0.10274029 0.061017036 0.093170166 0.09238052 -0.0066165924 -0.26445198 -0.28410912 0.1365099 0.17028141 0.045175552 -0.05894947 -0.1289959 0.018432617 0.09667969 0.01822567 -0.022795677 -0.0352602 0.01583767 -0.06598568 -0.22516918 -0.0083351135 0.10643673 -0.11609268 -0.019482613 0.07073879 -0.053578377 -0.055503845 0.2509508 -0.028475761 -0.17217064 -0.102181435 -0.22840786 -0.08254719 0.08217716 0.06132412 0.02025795 -0.059799194 -0.3898096 -1.4376144 -2.1366515 -2.5298443 -2.085544 1.0974722 11.450668 16.856384 16.278402 13.94776 4.995142 -0.19449282 -4.2368717 -10.494421 -19.271112 -21.00289 -18.202438 -16.504833 -14.889824 -12.699396 -10.2471 -6.448012 4.859769 13.374062 14.8126 16.401424 14.677359 13.203488 8.345339 3.3318844 -1.0703144 -3.4046803 -9.791055 -14.188248 -18.230019 -16.820326 -16.8571 -13.657269 -12.126135 -11.403357 -14.79458 -13.412182 -12.285572 -12.05277 4.7876453 12.986507 13.707185 17.981855 19.559114 13.478186 8.490439 5.9417114 -4.0222445 -7.7148876 -11.576599 -15.835079 -17.570293 -15.013657 -11.843484 -13.678396 -14.925465 -15.223652 -17.36606 -14.870892 -7.4943337 2.260188 11.836005 17.482506 20.020096 17.043644 12.695145 9.890558 7.886648 1.6099691 -2.6633716 -6.383458 -11.559764 -14.997839 -20.451189 -21.894442 -18.351534 -13.028759 -10.578386 -8.176384 -5.7142076 -1.384573 -1.2001004 3.4080296 9.495645 9.432667 9.201595 10.094473 7.59448 8.27399 9.0815 6.8107104 4.9837694 5.523221 3.7523441 2.5716734 2.1743364 1.204031 -0.043144226 0.019226074 
];
LinearAcc_y =[-1.9974344 -2.012463 -2.0205827 -2.0581193 -2.025882 -1.7468233 -1.638387 -1.6540302 -1.6367793 -1.4753027 -1.4966296 -1.4242699 -1.3719915 -1.2985555 -1.015911 -1.1150386 -1.0562644 -1.0603225 -0.82743514 -0.8570298 -1.2011714 -1.1348884 -0.64244133 -0.37670195 -0.87826174 -0.5486904 -0.67462677 -0.7350441 -0.8213325 -0.7211536 -0.76374716 -0.4995069 -0.6511305 -0.63850456 -0.6179522 -0.7149676 -0.40311813 -0.4883555 -0.5589973 -0.5908438 -0.5652046 -0.44387692 -0.4290774 -0.520237 -0.48209843 -0.4884145 -0.43741414 -0.4370514 -0.3573191 -0.36489597 -0.35993052 -0.3437208 -0.34035546 -0.3207161 -0.32714197 -0.41795683 -0.3480635 -0.3810814 -0.50736296 -0.3946856 -0.27472064 -0.24926233 -0.23082685 -0.23715839 -0.2877762 -0.2715017 -0.3300407 -0.21506694 0.0023710728 0.449599 0.7169111 2.6288126 4.1654496 5.3561115 2.892704 -0.56621027 -1.064796 -3.7889862 -15.237069 -18.927818 -19.766483 -18.982128 -15.342789 -15.081339 -11.659069 -11.533312 -10.871523 -10.387474 -8.081711 -6.8349447 -7.1732316 -5.8645163 -3.1019096 -0.9250274 -2.2685263 -3.6050613 -8.564362 -14.019557 -19.63128 -24.121235 -20.778254 -20.015427 -15.838762 -14.410625 -13.503933 -11.945799 -10.988783 -10.29799 -7.7624955 -5.5160513 -5.164949 -8.207567 -10.127224 -5.6740794 -2.4142237 3.5388327 2.1187904 -3.9756238 -8.982561 -11.972717 -24.192802 -22.041014 -23.18063 -19.42456 -18.817516 -17.065401 -15.968378 -14.284689 -11.15446 -10.812611 -9.81502 -9.147537 -7.6665173 -14.560428 -5.702133 0.4085102 3.1406202 -0.023278475 -4.70313 -8.23736 -10.907347 -17.954863 -24.070488 -24.420486 -28.657856 -25.416859 -19.770916 -17.203117 -16.737778 -13.8183 -8.178704 -7.9778194 -7.4817758 0.40521765 -0.25161672 -6.1433153 -3.222168 -0.22901028 -2.197265 -1.320488 0.14311638 -3.454948 -4.400093 -2.1323245 -2.0808442 -3.6797583 -4.2058673 -3.6842968 -3.72885 -3.322874 -3.2472856 -2.872954 
];
LinearAcc_z=[1.3928866 1.207634 1.3376219 1.180337 1.0024862 0.9243734 0.963374 1.0721481 0.88073146 1.1243334 0.9248249 0.6731239 0.98610115 0.6997252 0.6729176 0.8311135 0.5318424 0.3999561 0.05671668 0.6132727 0.88747275 0.63406944 0.069684625 -0.112284064 0.53326565 0.2586728 0.7320405 0.07673973 1.339243 1.2671137 0.30616698 0.594305 0.21969837 0.52956533 0.44665617 0.5256132 0.30929148 0.42133418 0.5508247 0.44263238 0.27704197 0.34213585 0.365377 0.47544336 0.098677754 0.16157931 0.24265599 0.3420502 0.29359442 0.1862567 0.20857984 0.30746585 0.37878132 0.0147304535 0.38537258 0.43108022 0.07257599 0.10458648 0.36925328 0.5424629 0.12755495 -0.011565447 0.19964635 0.34540796 0.19237316 -0.013328016 0.37139106 0.19835633 0.24249732 0.1015439 0.9669845 3.0492043 7.759084 13.364059 13.358563 6.7701015 -9.233398 -12.641524 -11.468289 -10.02316 -3.7532659 9.274248 5.0874596 7.3179398 13.377073 10.919303 11.422085 15.079177 18.230515 19.647861 19.101429 18.547487 18.247501 17.657862 14.432355 1.8563771 -18.163624 -18.969194 -18.249187 -16.38358 -5.379974 -2.424263 3.6508014 5.7940617 7.600858 8.751004 7.2899113 9.388453 11.147602 8.586692 8.539353 17.847477 17.640907 16.939512 16.739452 16.756802 16.115898 11.951947 -14.432336 -18.686817 -16.265438 -13.9246645 -11.649937 -5.3978357 -1.1798487 3.1618743 6.820717 5.0572476 6.5344353 11.149488 13.65225 15.775869 17.114824 17.178495 16.611967 16.250372 16.038916 15.775644 1.0467956 -12.417391 -23.087 -9.83098 -8.0183735 -8.102683 -14.728837 -10.936873 -3.6484807 4.3080416 7.125791 8.338853 8.240517 9.5943775 10.337816 8.0394945 6.929776 8.563004 8.893547 6.384499 0.73742914 -0.5802722 1.4121609 -4.3864346 -7.9644413 -2.750382 -2.5074642 -5.8319364 -6.887763 -4.786509 -7.0788608 -7.1941156 -6.022896 -5.7374425 
];
Gyro_x=[-0.6717926 3.175747 -1.1603692 -2.137522 -5.618629 -3.7864676 -8.427944 -5.985062 -6.0461335 -5.985062 -7.023287 -6.5957823 -11.420475 -19.90949 -22.352373 -24.978472 -17.100176 -8.61116 -17.52768 -19.054483 -12.214412 -7.939368 0.6717926 -11.481546 -14.474078 -4.6414766 -3.236819 2.4428823 -7.572935 -10.38225 -9.221881 8.061512 12.641915 7.817223 2.6871705 -5.6797013 4.275044 1.6489456 1.0382249 0.8550088 4.7025485 0.6717926 -2.992531 -0.061072055 4.763621 8.794375 6.22935 1.5268015 -0.54964846 2.6871705 0.0 -4.4582605 -3.7253954 0.3053603 -0.24428822 -3.4811072 -4.8246922 1.2214411 0.24428822 -4.3971877 -5.9239893 1.3435853 1.5878735 -2.6871705 -5.374341 -1.4657294 -2.259666 -3.2978911 4.213972 -18.260546 -42.689365 -16.428383 33.894993 176.00967 221.01978 248.80756 174.60501 55.14807 -104.12785 -193.78165 -227.49342 -240.50177 -289.17618 -273.41962 -214.79042 -210.39325 -191.33876 -124.15949 -57.102375 63.8203 155.00089 255.76978 350.5536 442.10062 453.9486 304.81064 206.42355 70.66037 -84.40159 -145.53471 -179.36864 -243.12785 -268.96136 -265.29703 -264.80844 -245.6318 -215.21793 -187.49123 -147.79437 -126.48023 -62.721004 30.658173 109.31898 87.333046 194.94202 456.39148 488.75967 449.3682 296.8102 182.11687 -1.2825131 -156.7109 -235.00528 -254.36514 -246.30359 -248.44113 -285.57294 -289.1151 -253.99869 -232.13489 -157.5659 -59.05668 103.63928 89.53163 141.07645 214.424 334.2474 449.00177 523.57074 279.28253 103.08963 28.948156 -23.695957 -77.561516 -194.94202 -286.24475 -284.3515 -292.16873 -297.2377 -262.60986 -185.04832 -138.14499 -125.07557 -80.004395 -5.435413 8.183656 32.36819 71.0268 71.94289 103.333916 88.55448 64.67531 84.95124 101.31854 90.936295 55.14807 53.926624 54.59842 38.9029 24.367752 18.99341 21.314146 
];
Gyro_y=[0.4275044 -0.6107206 0.48857644 -2.015378 -0.9160809 7.695079 7.878296 8.672233 -3.053603 2.259666 -4.030756 -9.893673 -1.0382249 -1.5878735 2.5650263 3.6032515 0.0 1.0992969 -10.137961 -8.244727 -2.015378 17.405537 12.214412 5.2521973 -2.3207383 -16.367311 -20.336994 -20.703428 3.236819 5.9239893 0.4275044 0.48857644 -4.4582605 -9.160809 -16.30624 -14.046574 -4.9468365 -6.5347104 -4.3971877 -2.6871705 -7.634007 -11.054042 -8.3057995 -1.1603692 1.5268015 0.0 1.3435853 -2.5650263 -7.023287 -1.0992969 -3.6643236 -1.4657294 -6.107206 -6.656854 8.366872 7.389719 -3.053603 0.4275044 -0.7939367 5.5575576 0.6717926 -0.6717926 -0.061072055 5.0689807 1.0382249 -4.3971877 5.2521973 0.7939367 1.4657294 -12.4587 -22.291302 -80.92047 -39.81898 -53.499123 -82.93586 -57.468803 -208.0725 -301.69598 -298.21484 -238.60852 -199.21706 -75.240776 -65.53032 -64.797455 32.551407 57.774162 31.024605 33.03998 110.35721 127.09095 138.08392 29.314589 57.957382 -56.186295 -157.07733 -183.64368 -297.35983 -385.9754 -342.18674 -281.9086 -278.12213 -201.41563 -92.8906 -45.742973 -70.355 -72.79789 7.511863 81.836555 52.155537 33.223198 74.44683 89.22628 139.30536 24.306679 -58.018456 17.894114 -138.45035 -223.52373 -221.26407 -342.79745 -256.86908 -259.0066 -249.96796 -200.49956 -130.44992 -63.63708 -40.002197 -73.28647 -22.169157 19.176624 37.681458 32.795696 -18.810194 121.35019 45.559757 -42.200794 -87.333046 -101.44069 -107.91433 -243.9218 -440.02417 -371.86774 -256.01404 -202.27065 -234.57777 -179.674 -98.509224 -37.253956 -32.97891 7.756151 32.490334 99.85281 111.09007 102.66213 54.59842 69.86644 92.82953 20.642357 -5.313269 21.436293 40.551846 -31.574255 -71.393234 -25.100616 -1.0382249 -65.71353 -53.010548 -34.811073 -4.763621 0.7328647 -21.98594 -10.565466 
];
Gyro_z=[0.4275044 -0.8550088 0.061072055 -0.24428822 -0.12214411 0.061072055 2.6871705 -0.7939367 -1.8321618 0.24428822 -0.48857644 -2.0764499 0.7939367 4.7025485 3.7864676 4.8857646 2.9314587 6.9011426 15.390158 13.924429 8.550088 8.244727 10.748682 21.497364 16.611599 0.12214411 0.6717926 -0.8550088 4.3361163 6.473638 7.878296 9.160809 3.9086115 2.9314587 -0.4275044 0.54964846 1.8321618 4.3361163 0.36643234 -0.3053603 -1.3435853 1.3435853 2.259666 -0.12214411 -1.5878735 -2.137522 -0.12214411 0.48857644 -2.4428823 -0.8550088 1.8932338 0.3053603 -0.36643234 -1.1603692 1.7710897 1.8321618 1.2214411 -1.5268015 -2.3207383 -0.4275044 0.7939367 0.6107206 1.8932338 2.4428823 2.137522 0.18321617 3.2978911 3.6643236 5.985062 27.60457 68.82821 101.868195 125.197716 103.45607 30.963535 -29.436731 -89.65378 -201.23244 -245.99826 -265.29703 -234.9442 -137.22891 20.52021 131.79349 204.16388 253.26581 303.5281 340.1103 353.54614 342.12567 341.88138 294.79483 231.2188 178.75792 120.31194 -45.620827 -149.93192 -262.36557 -340.17136 -321.84973 -246.24252 -128.19025 -60.03383 3.5421793 107.303604 155.12303 173.32251 196.22453 231.76846 289.54263 330.03342 355.92795 306.03207 238.18105 238.97495 160.68057 106.08217 51.97232 -120.31194 -241.47893 -306.94815 -271.52637 -225.17267 -131.24385 -24.306679 13.435853 72.00396 153.77943 203.2478 263.64807 397.0905 424.51187 413.33566 311.4675 292.6573 223.46266 55.5145 52.705185 -11.420475 -138.3282 -252.71617 -335.4688 -362.70697 -336.5681 -237.44817 -124.220566 -59.05668 14.901582 115.1819 155.30623 191.39983 210.08788 235.92137 235.00528 233.35631 210.4543 182.11687 113.410805 92.34095 89.65378 67.72891 35.116432 14.413006 5.8629174 -6.107206 -14.290861 -11.909052 -20.336994 -18.138401 -6.0461335 -5.313269 -5.374341 
];
Gravity_x=[9.122557 9.121767 9.121866 9.175853 9.24395 9.305335 9.319859 9.364259 9.363891 9.378694 9.410848 9.404382 9.427307 9.46689 9.501931 9.5095415 9.542302 9.569195 9.576703 9.587181 9.595537 9.603487 9.655839 9.667755 9.683666 9.690717 9.687027 9.678204 9.6747055 9.679763 9.685827 9.694136 9.697901 9.702669 9.707439 9.709224 9.714705 9.717996 9.717576 9.715522 9.718185 9.716899 9.715294 9.716985 9.717955 9.7185545 9.720751 9.720696 9.721122 9.716306 9.717196 9.718883 9.718102 9.714342 9.713173 9.720068 9.724292 9.723855 9.724221 9.72718 9.729621 9.7308655 9.731274 9.734757 9.739199 9.737951 9.741646 9.745731 9.747328 9.746723 9.745464 9.719132 9.640441 9.540994 9.399188 9.3281975 9.292727 9.081009 7.8877206 6.85959 5.660597 4.6960707 3.954142 4.025072 4.5574756 5.4742117 6.5656195 7.6635885 8.6303625 9.361652 9.7342 9.775997 9.597517 9.3375225 9.156791 9.200409 9.504495 9.70711 9.475127 8.720845 7.581576 6.337054 5.6608076 5.3562574 5.3685308 5.753251 6.3156514 6.979854 7.7285185 8.465827 9.116614 9.56785 9.665756 9.471464 9.288165 9.067301 8.899877 9.085109 9.366762 9.701313 9.405955 8.635223 7.6113386 6.558712 5.8304057 5.6390176 5.7137985 6.040311 6.714458 7.5270863 8.420937 9.213826 9.58446 9.535997 9.134186 8.729172 8.533891 8.611311 8.7279215 8.979683 9.508795 9.717728 9.2367325 8.264918 7.1232753 6.0343 5.360182 5.2030144 5.4175696 5.9324665 6.566283 7.1721888 7.6134396 7.9314375 8.125306 8.247296 8.17115 7.845503 7.8110685 7.8285437 7.7249775 7.703196 7.871729 8.067582 8.097037 8.146466 8.320149 8.430465 8.47544 8.469621 8.495752 8.535334 
];
Gravity_y=[3.1077325 3.1091387 3.1085224 2.9903498 2.8208504 2.6666198 2.6638608 2.5624597 2.5747218 2.5348525 2.4507334 2.4608324 2.3929682 2.275977 2.1679862 2.1587315 2.049536 1.9477061 1.9086828 1.8421619 1.7889353 1.7528718 1.5901933 1.5316051 1.4362258 1.379582 1.3738698 1.3739911 1.3720477 1.3516905 1.3218869 1.2685705 1.2273308 1.1772236 1.1201947 1.0697341 0.9956822 0.95434386 0.93093705 0.93047374 0.8987754 0.8771502 0.8475757 0.81434715 0.80811524 0.80602586 0.7834355 0.78131694 0.74949384 0.7566942 0.7392609 0.7197031 0.7222375 0.7216905 0.71941817 0.7048854 0.6872613 0.67948735 0.68285894 0.68090224 0.67402416 0.6673644 0.65640783 0.63659024 0.61785424 0.6070815 0.5762781 0.5544605 0.53580576 0.40184534 0.17991525 -0.2142188 -0.79274845 -1.5135816 -2.1301653 -2.3628926 -2.3133397 -1.8496654 0.2080135 1.6612487 3.2628062 4.6805334 6.7464848 7.4193583 7.668657 7.5124927 6.9524155 5.924253 4.5410495 2.8910499 1.1797528 -0.48335344 -1.7544211 -2.5516882 -2.978815 -2.9086604 -2.2251158 -1.2444757 0.23832974 2.0741813 3.7619689 5.108572 6.123546 6.9118004 7.374646 7.421062 7.2069345 6.7796164 6.024171 4.9455876 3.556854 1.8547897 0.18728533 -1.1499647 -2.1497447 -2.797649 -2.7370348 -2.3747327 -1.8345499 -0.8141072 1.9917978 3.4677563 4.8961167 6.136564 6.9868555 7.4337373 7.690257 7.649232 7.1452165 6.2495832 4.8278317 2.8089004 0.72607446 -1.104695 -2.4655354 -3.4238427 -3.6694274 -3.2933593 -2.551376 -1.446286 -0.2665744 1.2874418 3.0216002 4.7063313 6.0998545 7.1705227 7.897692 8.223504 8.174321 7.729226 6.9805474 6.0529766 4.993961 3.8223908 2.7252562 1.7583412 0.96523345 0.040131956 -0.15924963 -0.27467808 -0.30864918 -0.2802205 -0.15014906 0.05608195 0.3389239 0.598209 0.8075763 1.0240136 1.2476234 1.4105735 1.4865339 1.5506488 
];
Gravity_z=[-1.8142031 -1.8157637 -1.8163252 -1.7412349 -1.6621034 -1.5717069 -1.4881027 -1.383769 -1.3633451 -1.3360292 -1.2650007 -1.2931623 -1.2529685 -1.1697271 -1.0878986 -1.0386869 -0.9561711 -0.89849454 -0.90225774 -0.92885697 -0.9464408 -0.9331877 -0.6374974 -0.5992407 -0.5781199 -0.59757745 -0.6665966 -0.78415775 -0.82944566 -0.8034417 -0.7795803 -0.76472735 -0.78406215 -0.8016995 -0.8253311 -0.87007457 -0.8963725 -0.9056202 -0.9340642 -0.9556369 -0.95888036 -0.9913914 -1.0320132 -1.0428032 -1.0385817 -1.0346099 -1.0313195 -1.0334467 -1.0528314 -1.0914087 -1.0954285 -1.0934949 -1.0987647 -1.1318365 -1.1432838 -1.0925986 -1.0659347 -1.0748752 -1.0694096 -1.0434183 -1.0249792 -1.0174719 -1.0207024 -0.9997998 -0.9677829 -0.98698246 -0.96880615 -0.94004244 -0.9343021 -1.0051383 -1.0788538 -1.2895664 -1.6136376 -1.6878604 -1.8132921 -1.8899425 -2.1128266 -3.2069283 -5.8233137 -6.8085732 -7.3131456 -7.2256413 -5.917776 -4.992224 -4.073264 -3.125038 -2.1741524 -1.5306909 -1.0325056 -0.4143056 0.15463965 0.60550034 0.98996234 1.5716095 1.8574816 1.7500151 0.9401117 -0.6274205 -2.5170486 -3.9768069 -4.9535494 -5.4694242 -5.1602144 -4.4393563 -3.6005363 -2.8281276 -2.0839925 -1.220173 -0.38695785 0.20318858 0.63757837 1.0892066 1.6457388 2.2670062 2.2976074 2.4753969 3.0775325 2.826979 2.251347 1.1798847 -1.9316113 -3.0948288 -3.7770271 -3.9365268 -3.6552165 -3.0185108 -2.093519 -1.0836439 -0.179656 0.6753145 1.3965147 1.8400702 1.9445605 2.0036964 2.5803447 2.8721492 3.1429935 3.3420768 3.6720881 3.6665947 2.3837242 0.2804197 -1.3126596 -2.389972 -2.867246 -2.8881118 -2.2506142 -1.2136586 -0.027820611 1.1114349 2.0799673 2.8445678 3.6422894 4.318798 4.7668376 5.006069 5.3358216 5.8836093 5.9272447 5.8998995 6.0332274 6.062395 5.8466845 5.575064 5.5220914 5.4265633 5.127697 4.903982 4.772918 4.737741 4.667207 4.573179 
];
%}

%{
LinearAcc_x =[-0.6969609 -0.59332705 -0.38008595 -0.40770435 0.02149582 -0.024527073 -0.05116558 -0.07070637 -0.1135149 -0.18134308 -0.20419455 -0.21527386 -0.10337973 -0.15356112 -0.22147608 0.034791946 0.052657127 -0.019655228 -0.13083124 0.0996933 -0.16116571 -0.018807411 -0.100700855 -0.135746 -0.17547607 0.05458355 -0.05159378 -0.012910843 -0.043251514 -0.052840233 -0.06353521 -0.107460976 -0.073275566 -0.09241295 -0.071202755 -0.10687876 0.040991783 -0.08403063 -0.16895676 -0.1283412 -0.14953566 -0.078798294 -0.09735155 -0.012993336 -0.054884434 -0.16939116 -0.13453293 -0.06750393 -0.1026206 -0.1910739 -0.24944735 -0.08036518 -0.30743313 -0.31959486 -0.004217148 -0.08078098 0.23580265 -0.18434334 -0.2668333 -0.23939371 -0.17456007 -0.029455185 -0.09651852 0.06699276 -0.021028519 -0.1747961 0.17410946 0.18320274 0.27007484 0.14815712 0.02154255 -0.08240032 0.08443165 0.14821911 -0.18238449 -0.33670235 -0.41043615 -0.22175217 -0.33970547 -0.343081 -0.45929527 -0.5367098 -0.32294416 1.2209225 6.262622 10.747553 14.4167 13.390911 12.820059 13.224021 11.414505 11.122981 8.900896 8.664706 7.972764 5.0784025 2.4405594 -4.455225 -8.395258 -10.244078 -12.871378 -14.623824 -14.057094 -12.047277 -12.693425 -14.063388 -14.957756 -15.852789 -16.602888 -16.085138 -9.271463 -9.262365 -8.317242 -0.9826207 -7.278635 2.049964 -2.9483423 -6.0183973 -7.088379 -8.046239 -8.915974 -10.80097 -18.247677 -16.205612 -11.544066 -10.829081 -8.765427 -5.167868 -5.6082773 -4.359956 -2.2055407 -1.8147373 -0.764328 1.60256 1.3751616 1.382381 1.6739416 1.0330772 0.85973454 1.4064999 0.82301235 1.1381865 0.79709244 0.080836296 0.046575546 -0.3182621 0.20279312 -0.014446259 -0.348979 -0.2924161 0.18889904 0.26316643 -0.47046947 -0.11879349 0.16496086 -0.16260576 -0.49399185 -0.19728565 -0.10794258 0.15979195 0.25077152 -0.5644884 
];
LinearAcc_y =[-2.6275136 -2.6007626 -2.53155 -2.5779645 -0.028481424 -0.0044882298 -0.03542322 -0.09352851 -0.108029604 -0.13390166 -0.1402154 -0.11768001 -0.085715175 -0.012945116 -0.028003037 -0.023245633 0.008011758 0.015503883 -0.051886797 0.015547097 -0.070403814 -0.06187129 -0.12527359 -0.11848962 -0.07854843 -0.09106004 0.005782366 -0.017620683 0.036774874 -0.011761427 0.03520167 -8.511543E-4 -0.021633863 -0.10377014 -0.032925963 0.027817488 -0.0383631 -0.07415199 -0.03261912 -0.02723217 -0.055814743 -0.07045436 -0.04325545 0.0070021152 0.025539637 -0.050608158 -0.009838462 -0.040794253 0.0049294233 0.0031112432 0.0110247135 -0.066066146 -0.049328923 0.047112346 0.07974601 0.035674334 -0.058641076 -0.123027325 -0.023795128 -0.06648338 -0.04482138 0.051066756 0.08243537 -0.04559672 0.10378218 0.045090675 0.059078693 -0.012409091 -0.0968225 -0.019533873 -0.061417937 -0.10641599 -0.04287386 -0.08183229 -0.05185795 0.0064001083 -0.01937759 -0.027220488 -0.07246041 -0.08485782 -0.2771994 -0.7900418 -1.5022535 -2.400391 -2.8451955 -2.8769357 -3.758635 -4.8282437 -5.5029054 -4.955595 -6.7062435 -7.633736 -10.644323 -12.068564 -14.191433 -15.8076515 -16.297987 -14.846804 -12.877903 -10.66466 -8.247848 -6.332754 -5.5483537 -4.573231 -3.9346843 -3.9643216 -5.289173 -7.364038 -8.606924 -10.33688 -22.941198 -27.85863 -24.589684 -16.100311 -21.783472 -12.76416 -18.19379 -22.118683 -24.023075 -26.22537 -30.609608 -29.62692 -22.415464 -16.145191 -14.70015 -9.713751 -5.814292 -4.971841 -3.1286013 -2.8747358 -3.021055 -1.1710925 -2.0332346 -1.016315 -0.98996925 -1.108582 -1.2375717 -1.1571383 0.3138399 0.6502218 0.33986902 0.35632467 0.34673357 0.25024033 0.18195152 0.46835327 0.13879395 -0.057784557 0.16389894 0.106812 0.088160515 0.117907524 0.19526386 0.22627544 0.41319227 0.46804285 0.25573778 0.15148115 0.45886707 0.30310726 0.3310995 0.2145114 
];
LinearAcc_z =[1.0857048 1.0315623 1.1938596 1.1899118 0.052628994 -0.063016415 -0.02111721 0.05970955 -0.012192726 -0.17841291 0.02064991 0.08140564 0.186481 -0.08003044 -0.011671543 0.1669569 0.158566 -0.0072922707 0.0131902695 0.016868591 -0.07171154 4.682541E-4 -0.061950684 0.06884956 0.059184074 0.13900757 0.110771656 0.15805292 0.05934429 0.15425825 0.120863914 -0.014157295 0.06291962 0.050881863 0.018481731 -0.14500046 0.001273632 -0.03196621 -0.07211447 0.10976744 0.053581238 -0.01640749 -0.01833105 0.026851177 -0.030026436 0.048071384 -0.06650591 0.11841822 -0.025419712 0.045989037 0.0635643 -0.0013446808 -0.089553356 0.003973961 -0.033614635 0.30767822 0.19216347 -0.042753696 -0.06628895 -0.0993247 0.0047426224 0.21096039 -0.14407825 0.11879921 0.19073534 0.011496544 -0.10536194 -0.05575466 -0.072594166 0.047869682 0.07036018 -0.043441772 -0.0067834854 0.2706213 -0.0038380623 -0.062304974 0.0164361 -0.22091913 -0.15394306 -0.3229761 -0.36807775 -1.1228533 -1.0926585 -1.8787563 -7.5214148 -10.762412 -10.508728 -6.9546766 -7.17192 -5.391866 -0.67728853 4.7314067 9.022168 12.477125 12.505171 13.0124 15.380021 15.889281 12.226373 9.971838 9.061818 8.017796 7.3628316 7.2153087 6.457753 6.2635474 7.6821823 9.889024 10.851757 12.489953 20.485464 19.66105 19.836536 19.202868 17.958689 17.44933 12.4262905 2.0167837 7.7460237 -2.3752267 -8.486997 -7.2304363 -8.3271055 -10.082288 -8.026216 -5.9222 -5.1335945 -1.8641815 -1.9141531 -1.5506806 -0.124966145 1.1985453 0.62694657 -0.7536316 1.9515741 3.5925896 3.3787246 3.1238627 0.82368016 -0.89176375 -1.8777052 -0.4747219 0.73759294 -0.60448766 -0.42172933 -1.0423577 -1.4264627 -1.6877803 -1.5160394 -1.0297165 -0.83452916 -0.8653753 -1.0642323 -0.8056655 -0.7598829 -1.3900121 -1.3461056 -0.87842226 -1.2657859 -1.4633038 -1.1560029 -0.979916 
];
Gyro_x =[0.8550088 -0.7939367 0.4275044 1.1603692 0.6107206 1.0382249 0.3053603 1.5878735 1.9543058 -2.137522 -1.7710897 -1.0992969 -1.0382249 -0.9771529 0.061072055 -0.48857644 -1.7710897 -0.54964846 0.6717926 0.4275044 -0.4275044 -0.7328647 -2.3818104 -1.5878735 -2.259666 -0.061072055 -1.5268015 0.061072055 0.0 -0.24428822 0.4275044 0.061072055 0.0 1.6489456 -0.6107206 0.36643234 1.0382249 0.7328647 0.4275044 1.0382249 0.36643234 0.4275044 -0.9160809 0.24428822 -2.015378 -2.015378 -1.8321618 -5.2521973 -7.328647 -7.695079 -9.099736 -6.778999 -9.282953 -12.153339 -8.672233 -2.259666 -7.817223 -9.282953 -7.023287 -5.435413 -8.061512 -1.6489456 -0.8550088 -1.8932338 0.48857644 2.8703866 1.3435853 0.36643234 2.0764499 -2.3207383 -3.2978911 0.36643234 2.259666 -5.0689807 -5.1300526 0.6107206 -0.6107206 -0.6107206 -2.3207383 10.199034 28.45958 29.98638 -15.695519 -45.07118 -76.34007 -123.67091 -146.57294 -184.13225 -186.0255 -208.01143 -217.72188 -226.69948 -209.23286 -188.71265 -170.75746 -130.20563 -117.19728 -111.456505 -77.25615 -34.99429 -14.779438 -8.916521 5.1300526 18.199472 46.7812 58.140602 53.926624 74.874344 93.68454 232.44025 273.11423 261.02197 408.57205 608.1555 565.64935 674.72406 676.5563 622.81287 301.2074 250.39543 162.32951 134.48068 96.00527 60.58348 42.811512 27.238136 8.061512 -4.3361163 -21.741652 -13.191565 -16.733744 -25.833479 -20.275923 -14.657294 -16.794815 -7.450791 -4.5804043 -6.5957823 -14.290861 -8.733305 -4.519332 -2.259666 -1.3435853 2.015378 -0.36643234 -3.8475394 -3.969684 -5.8018456 -5.007909 -4.213972 -2.8093145 -1.7710897 -0.48857644 -3.175747 -4.4582605 -2.8093145 -4.030756 -7.450791 -6.0461335 -5.618629 -4.519332 -2.6871705 
];
Gyro_y =[0.0 -2.8703866 0.0 0.48857644 -1.1603692 -4.763621 -3.6643236 -0.7939367 -0.7939367 -0.12214411 -0.48857644 -1.8321618 3.3589633 0.6717926 -1.4657294 1.5268015 3.9086115 4.3361163 0.36643234 0.4275044 -1.0992969 -0.6107206 -0.7939367 -0.36643234 -1.3435853 0.6107206 0.54964846 0.24428822 -0.54964846 0.12214411 0.061072055 -0.7328647 2.5650263 -1.2214411 -0.24428822 -0.7939367 2.015378 1.2825131 -2.3818104 -1.2214411 1.6489456 -1.7710897 -0.061072055 -0.3053603 1.4657294 0.12214411 2.3207383 2.3207383 -1.1603692 -6.7179265 -1.1603692 -2.9314587 -11.847979 -9.160809 5.191125 14.046574 2.137522 -0.36643234 -6.0461335 0.3053603 -0.36643234 2.5039544 10.809754 -9.954745 1.7100176 3.6643236 0.7939367 1.4657294 2.9314587 -1.4657294 -1.8321618 3.9086115 5.6797013 1.2825131 -2.992531 10.38225 11.786907 1.7710897 4.519332 2.3818104 11.603691 34.93322 -22.963093 -107.18146 -105.7768 -40.490772 -64.43102 -124.77022 -154.32909 -206.91214 -224.6841 -202.94244 -170.81856 -136.55711 -120.0066 -115.85368 -140.09932 -72.248245 -1.8932338 -39.452545 -49.956944 -40.857204 -58.5681 -53.68234 13.130492 9.771529 -2.3207383 111.51757 187.00264 -82.44728 31.268892 134.4196 -259.98373 -146.81723 -82.87478 -356.7219 -305.5435 -348.23285 -32.246048 11.054042 -77.8058 -65.10281 -0.9771529 -47.391914 -53.80448 17.22232 -39.757908 -43.36116 -9.282953 9.893673 -11.237258 -9.405097 25.039545 28.21529 16.428383 -19.176624 21.68058 39.14719 6.7179265 3.4200351 7.023287 6.0461335 4.4582605 -4.213972 8.061512 10.68761 -5.8629174 -18.382689 -10.443321 15.634446 1.5878735 0.0 5.496485 7.634007 0.8550088 -6.7179265 -6.22935 3.5421793 7.572935 -3.969684 -4.275044 5.2521973 
];
Gyro_z =[1.7100176 2.5039544 0.9160809 0.54964846 1.2825131 0.6717926 0.9771529 -0.18321617 -0.4275044 -0.18321617 0.18321617 1.2214411 1.3435853 1.0992969 1.7100176 1.4046572 0.9771529 0.36643234 1.1603692 0.9771529 1.5268015 0.24428822 0.7939367 0.7328647 1.7100176 0.12214411 0.9160809 0.12214411 0.24428822 0.7328647 -0.36643234 0.061072055 -0.24428822 0.6717926 1.1603692 -0.3053603 -0.8550088 -0.36643234 -0.24428822 -0.48857644 1.0382249 1.2214411 0.4275044 -0.36643234 0.54964846 0.18321617 -0.48857644 1.0382249 1.8932338 2.1985939 0.48857644 3.236819 4.1528997 2.8093145 -1.7100176 -2.3818104 0.36643234 -3.969684 -1.8321618 -0.12214411 0.12214411 -5.191125 -3.7864676 2.3207383 -0.9160809 -1.1603692 -4.030756 -1.3435853 -2.6260986 -0.4275044 -0.24428822 -0.9771529 -0.6717926 1.5268015 2.5039544 3.053603 4.030756 4.763621 7.572935 10.321178 15.695519 53.560196 54.720562 13.374781 -48.97979 -73.28647 -83.485504 -153.84052 -164.89456 -201.59886 -202.45387 -196.9574 -209.11073 -246.9754 -252.22758 -207.27856 -149.19905 -136.12962 -98.570305 -35.666084 -0.8550088 32.30712 81.47012 109.07469 168.25351 210.94289 262.732 371.07382 391.2276 517.7078 475.01843 326.308 384.4486 119.33481 17.955185 -34.44464 -110.96793 -205.26318 -254.91478 -214.79042 -113.77724 -100.15818 -94.72276 -47.941566 -39.635765 -46.720123 -3.9086115 8.244727 8.061512 19.298769 36.643234 22.84095 11.6647625 10.443321 10.626538 12.4587 7.1454306 1.5268015 -4.030756 -5.6797013 -1.7710897 -4.8246922 -4.8857646 2.259666 1.9543058 2.5650263 -1.4657294 1.2825131 0.7939367 -2.0764499 0.8550088 0.9771529 -1.4657294 -0.4275044 2.6260986 4.5804043 5.374341 4.1528997 0.6717926 4.1528997 4.7025485 4.3361163 
];
Gravity_x =[8.5591135 8.56089 8.569773 8.570024 8.021072 8.028177 8.04051 8.046332 8.048074 8.049352 8.047874 8.04893 8.0463085 8.037524 8.039823 8.037348 8.031129 8.018844 8.009802 8.008131 8.008464 8.010084 8.010953 8.011153 8.011948 8.01087 8.011913 8.009981 8.00935 8.008524 8.007472 8.007905 8.006988 7.9984407 8.00254 8.002128 8.002313 7.9981084 7.9966273 8.002551 8.000577 7.9962716 8.000222 8.000197 8.000849 7.9978228 7.9954486 7.9926615 7.988145 7.98196 7.987554 8.003899 8.006874 8.027524 8.054798 8.081335 8.060595 8.033051 8.037129 8.046773 8.055624 8.048598 8.049553 8.035993 8.017539 8.0330305 8.046349 8.037415 8.030947 8.03509 8.029329 8.022065 8.026047 8.028153 8.01459 7.998698 7.9985285 7.9953914 7.9595766 7.9340916 7.923207 7.903821 7.8846908 7.8020196 7.657916 7.8204775 8.153431 8.40149 8.592024 8.884166 9.246679 9.758203 9.769432 9.55375 9.150159 8.563364 7.770208 6.8917937 6.0690827 5.355636 4.8021874 4.453115 4.2910037 4.3198595 4.5062323 4.8806944 5.401772 6.119951 6.9840574 7.947508 9.611382 9.760222 9.177342 8.289006 7.249466 6.3257174 6.2478213 6.745918 7.7625 8.711093 9.138765 8.643649 8.182985 7.845342 7.504359 7.244119 7.048469 6.8738976 6.766668 6.7066855 6.698878 6.7426243 6.8470426 6.933968 6.9909062 7.061496 7.1223044 8.225821 8.258248 8.247684 8.227815 8.208575 8.192302 8.16764 8.149777 8.142942 8.150614 8.14858 8.147557 8.152016 8.170243 8.163347 8.147349 8.149976 8.1477995 8.131988 8.132527 8.142408 8.16192 8.176505 8.176233 8.178645 
];
Gravity_y =[1.6422709 1.6339132 1.6227974 1.6186892 -0.93065006 -0.9321475 -0.9335145 -0.9376032 -0.93413293 -0.93422556 -0.942735 -0.95273817 -0.96263444 -0.9714435 -0.97927463 -0.9869693 -0.9927006 -0.99853 -1.0025458 -1.0030574 -1.0078303 -1.0152605 -1.022555 -1.0326778 -1.0432374 -1.0597826 -1.0602069 -1.0659715 -1.0658756 -1.0658857 -1.0657947 -1.0658046 -1.0659741 -1.0618781 -1.0631897 -1.0681217 -1.0660267 -1.0625392 -1.0623349 -1.0620867 -1.0622408 -1.0672995 -1.071803 -1.0736051 -1.0743085 -1.0836194 -1.0892583 -1.1028752 -1.1090548 -1.124531 -1.1557935 -1.1906445 -1.218323 -1.261843 -1.3067355 -1.347825 -1.360782 -1.3658203 -1.3854504 -1.3981017 -1.4130098 -1.4278116 -1.445024 -1.423486 -1.4172364 -1.4332457 -1.4410383 -1.4341174 -1.4211503 -1.4134728 -1.4018655 -1.3906095 -1.4010346 -1.4038242 -1.3984722 -1.3941735 -1.4199387 -1.4376798 -1.4527531 -1.4758098 -1.5151774 -1.5526057 -1.55688 -1.5999612 -1.7913492 -2.0242128 -2.1114347 -2.0923002 -2.0546248 -1.9057382 -1.4828693 -0.13878727 0.8485853 1.9472148 3.0833268 4.320669 5.589426 6.6596494 7.421261 7.9786363 8.392177 8.627312 8.716331 8.693715 8.585078 8.34123 7.9719768 7.39473 6.5202327 5.2781982 1.5697883 -0.7093805 -3.3762555 -5.233218 -6.493198 -7.211251 -6.5053487 -5.1126075 -3.125201 -0.82670975 3.2814152 4.5646763 5.403141 5.844897 6.179096 6.409936 6.5020614 6.611519 6.703582 6.701624 6.689886 6.674021 6.585421 6.5050716 6.476371 6.456406 6.434138 5.198242 5.148064 5.125648 5.1178493 5.1317267 5.1438026 5.1601686 5.179832 5.1911407 5.18362 5.170586 5.1605196 5.1605425 5.1495285 5.150662 5.152591 5.1455674 5.145241 5.15525 5.1445837 5.127911 5.104932 5.0784907 5.06186 5.0471063 
];
Gravity_z =[4.4960957 4.49576 4.482847 4.483851 5.564768 5.554266 5.5361676 5.527007 5.5250607 5.5231795 5.523887 5.520633 5.5227394 5.5339737 5.5292573 5.5314803 5.5394835 5.5562105 5.568515 5.5708237 5.569483 5.5658045 5.5632176 5.561058 5.5579414 5.556365 5.5547795 5.5564613 5.5573907 5.558577 5.56011 5.5594845 5.5607734 5.5738425 5.567707 5.5673547 5.5674925 5.5741963 5.5763583 5.567903 5.570707 5.5759196 5.569385 5.569073 5.5680037 5.570545 5.5728545 5.574176 5.579419 5.585169 5.5707726 5.539885 5.5295606 5.4897165 5.4390297 5.389412 5.4171457 5.456651 5.445682 5.428181 5.4111657 5.41773 5.411743 5.4375424 5.4663444 5.4393554 5.41757 5.432649 5.445604 5.441489 5.452984 5.4665394 5.4580293 5.4542127 5.4754906 5.499773 5.4934216 5.4933753 5.541214 5.5715833 5.5765057 5.593693 5.6194453 5.721801 5.8581357 5.559951 5.0233245 4.605175 4.257468 3.68919 2.9103944 0.9636322 -0.092170335 -1.0510045 -1.7140769 -2.0423012 -2.133674 -2.079092 -2.064343 -1.9567538 -1.6372975 -1.3819 -1.3353752 -1.388702 -1.4699227 -1.6652513 -1.8544052 -2.008621 -2.209048 -2.2689464 -1.1521672 -0.636568 -0.7400438 0.27597147 1.205816 2.0380175 3.8490984 4.9521937 5.1134205 4.4276166 1.3732018 0.7882966 0.12325171 -0.6768794 -1.2937278 -1.6142526 -2.0524716 -2.2820406 -2.3333538 -2.5057886 -2.557507 -2.482912 -2.4332292 -2.4030185 -2.3139155 -2.1495237 -2.01123 1.2184148 1.2120879 1.368872 1.5103188 1.5668595 1.6117858 1.683063 1.7090504 1.707312 1.6935105 1.7424239 1.7767168 1.7560837 1.7028881 1.7322924 1.8005157 1.8086983 1.8194166 1.86133 1.8882872 1.8910508 1.868993 1.8772537 1.9227937 1.9511082 
];
%}


LinearAcc_x =[3.5820394 3.9504628 3.3154683 4.2141604 4.759308 4.3955 -0.008296013 -0.20966434 -0.8977699 -1.1062031 -1.4634495 -1.2271538 -0.22432518 -0.7165127 -0.93319225 -0.7939615 -0.7520952 -0.2150135 -0.844059 -1.1031666 -0.69040585 -0.78839016 -1.0523396 -1.0420885 -0.6940832 -1.1152611 -1.4093304 -0.83058167 -0.6851587 -0.70574665 -1.0845413 -0.72640896 -0.8822298 -0.73710155 -0.9489641 -1.1572456 -0.68880653 -0.79862785 -0.8504305 -0.70303154 -0.41103363 -0.9856787 -0.675807 -0.543005 -0.8233156 -0.9217558 -0.9136944 -0.8891983 -1.0852566 -0.98168755 -1.2325315 -1.2161007 -0.6931305 -1.0421515 -0.9171095 -1.2502956 -1.1392937 -0.8374262 -0.94888496 -1.0893879 -1.8009729 -3.024562 -4.747842 -5.866889 5.444092 11.213932 18.313644 18.229773 18.025343 8.006799 2.3146982 -0.8309107 -6.230023 -8.869156 -15.301211 -19.04688 -21.23346 -17.464947 -17.08032 -14.194321 -11.545822 -1.5279255 16.078405 19.047724 18.456005 8.107899 3.4199114 -2.0351458 -6.2192616 -7.121265 -10.962988 -14.7441435 -17.423489 -16.503601 -12.432905 -12.918001 -16.648283 -19.290327 -18.223492 -19.173203 -15.072572 4.2314253 19.074986 21.874735 10.8952675 1.6946311 -6.309671 -6.6574454 -5.3248973 -12.823946 -14.957976 -17.439808 -15.962889 -16.448566 -16.826254 -19.421741 -17.83221 -14.634914 -8.132009 -2.649983 7.0862107 11.947027 15.300505 13.793391 7.7323155 -4.177272 -6.041371 -4.180078 -5.917776 -18.584522 -19.431084 -19.664072 -11.665657 -8.650373 -8.07496 1.2684474 1.9977779 7.1325088 10.47035 11.661933 11.248877 13.968811 12.651784 11.089317 14.28304 14.700079 11.399729 7.681473 7.5747595 6.906314 5.6339626 4.7839627 5.123167 5.4029436 5.310067 5.3656473 5.1101446 5.240099 5.3404875 5.31975 4.455987 5.460331 5.9945993 4.479975 5.499211 5.8330135 4.0657163 4.006139 4.6929517 
];
LinearAcc_y =[-5.435117 -5.3165183 -5.238564 -5.2725897 -6.225677 -6.0166993 0.13452864 -0.22704077 -0.54094636 -0.3299032 -0.49442655 -0.38844836 -0.15856445 0.012425721 0.022056341 -0.25559974 0.17952102 -0.72144383 0.46003884 0.2137512 0.28465253 -0.027873814 0.054874778 0.22829187 -0.20060492 -0.20993137 0.23629808 0.047286987 -0.24969149 -0.30280793 -0.1526277 -0.27210474 0.10490227 -0.056885242 -0.1274364 -0.2284975 0.21684694 -0.1409707 -0.063610315 -0.058541298 -0.059793234 -0.36050713 -0.19372654 0.009867668 0.050512552 0.22190773 0.08471811 0.1923995 -0.107287526 0.09804046 0.0026375055 -0.01000309 -0.046860814 0.04363382 -0.061412334 0.6504147 0.38809717 0.08664358 -0.109231055 -0.03816676 0.09818417 0.32228667 -0.37982318 0.7691051 1.8127007 2.398255 2.453003 2.0785604 0.8956721 -10.800933 -18.859686 -24.870846 -31.908588 -31.717314 -24.320261 -19.911491 -17.604702 -20.63684 -21.234795 -23.262142 -21.863214 -19.66857 0.6101978 3.7028751 2.5884924 -9.533141 -15.98529 -23.558296 -30.72905 -34.936916 -30.504791 -25.843733 -22.376953 -18.150623 -16.070122 -15.812535 -13.585301 -13.447752 -14.523056 -16.039284 -17.976786 -10.49658 3.3331003 4.750021 -9.05558 -20.250862 -30.440628 -34.079865 -35.80519 -27.223385 -23.964832 -20.689419 -19.778877 -14.399973 -16.478107 -16.582499 -15.445511 -20.069778 -22.34735 -18.023823 -9.137468 -5.701442 -3.852715 -7.6100054 -15.349269 -29.110937 -34.174145 -35.985214 -33.04465 -18.34816 -16.050085 -15.561067 -11.646242 -8.739911 -7.8722963 -2.1464844 0.5809405 -3.9206722 1.6843855 3.4843116 0.46588862 -2.058877 -1.4127362 -2.5323384 -5.0651975 -4.8822484 -4.600224 -4.232271 -4.8360157 -4.906133 -4.96725 -4.6126733 -3.9854932 -3.7783716 -3.7880344 -3.658808 -3.3342843 -3.1859574 -3.3766038 -3.2581744 -3.2364886 -3.2090373 -3.30318 -3.2831557 -3.344452 -3.6311107 -3.527259 -3.2869606 -3.3051074 
];
LinearAcc_z =[9.301073 9.736578 9.54435 9.052257 9.14974 9.191623 -0.3005159 -0.62389064 0.15545344 -0.6655309 -0.17085147 -0.7710078 -0.007242441 -0.37421155 -0.6520405 -0.268003 -0.5103967 -1.0476047 0.6026944 0.044832468 0.023007154 0.53620243 0.4829563 0.30975807 0.08160865 0.39744973 -0.35450804 -0.3849461 -0.44352347 -0.2696613 0.0075110197 -0.065538645 -0.34379113 -0.11951387 0.12986171 0.1261369 -0.32122278 -0.13885152 -0.3194195 -0.34595335 -0.22000706 -0.10495329 0.08524275 0.014546394 0.105363965 0.051560998 -0.15665424 0.03704059 -0.119069815 0.010447741 0.1813209 0.13241827 -0.28525752 0.028602958 0.22963786 -1.143686 -1.1790744 0.69781184 0.4207181 -0.09072161 -0.022667795 0.53395253 2.5765367 5.0534377 16.020452 10.9553995 3.9912581 -10.066852 -14.847438 -8.662335 -5.703031 -3.6321876 -0.777869 4.851245 1.2872282 6.233516 6.256009 4.152652 7.439439 16.555109 17.972496 17.99947 17.001 16.3167 15.283494 -18.36563 -24.331312 -22.715675 -20.999146 -18.086721 -10.47637 1.7824744 3.302795 1.2203693 0.25916123 3.4699295 4.871863 3.549024 9.577138 13.775612 16.333754 16.179283 15.205034 13.73498 -1.2673783 -26.226038 -24.57667 -23.180977 -16.558481 -3.4992323 -5.185238 -2.7951357 -4.350062 -6.3330326 -2.1857107 3.3341336 6.130429 14.124856 14.835953 14.98304 14.112472 13.028787 12.031851 -8.663365 -15.626925 -25.96406 -24.48705 -23.405756 -17.896996 -1.4639647 -0.012665272 1.5320911 -0.23972178 0.19815397 -2.5742197 6.7247496 7.9809275 6.4433126 7.6800327 6.728094 5.9502163 1.5431328 -5.4353476 -2.3555365 -8.360288 -13.867664 -11.630753 -9.027038 -7.986607 -10.117412 -8.782035 -7.589617 -6.276565 -6.1223197 -6.2485375 -4.7043424 -4.674302 -4.512272 -5.427357 -5.2659497 -4.9059267 -5.054058 -5.3654294 -4.8734465 -4.5949664 -4.981269 -5.0859756 -4.3011427 -4.770257 
];
Gyro_x=[-0.036240887 0.031977255 -0.28672937 -0.11192039 -0.43595657 -0.4146384 -0.107656755 -0.16628173 -0.48712018 -0.50737244 -0.34535435 -0.20785217 -0.07781132 -0.12897493 -0.2771362 -0.15242493 -0.3016521 -0.3783975 -0.45834064 -0.39758387 -0.4572747 -0.34855205 -0.2920589 -0.05649315 -0.26008168 -0.07034996 0.0628886 0.024515893 -0.20252262 -0.163084 -0.174809 -0.07461359 -0.11831585 -0.13430446 -0.07141587 -0.0010659085 -0.09486585 -0.06928405 -0.0884704 -0.019186351 0.015988627 -0.019186351 -0.08953631 -0.08527268 -0.11831585 -0.23023623 -0.2387635 -0.26754302 -0.061822694 0.037306797 0.037306797 -0.044768155 -0.1769408 -0.18120444 0.012790902 0.18120444 -0.14816129 -0.48605427 -0.45087928 -0.57559055 -0.7983655 -0.57878834 0.2622135 2.899271 4.6590858 6.0266466 4.883993 1.9506125 1.5093265 0.81435406 -2.1392782 -3.0975301 -3.611298 -4.6558886 -4.428849 -4.3137317 -4.3904777 -3.5441456 -1.7662104 0.2366317 2.1520693 4.487475 7.578609 9.85539 7.248178 4.9447494 2.8235915 -0.90495634 -3.2819324 -3.4290276 -3.3384256 -4.365961 -4.77527 -4.6271086 -4.619647 -4.1271977 -3.5835845 -1.1959493 -0.50097704 1.1117425 5.600283 7.1096096 9.614495 8.868359 3.7573276 3.3682709 2.142476 -1.0339313 -2.2735827 -2.5272691 -2.6743643 -3.8969615 -4.6942616 -3.856457 -3.237164 -2.9099302 -0.41037476 1.0136789 4.8061814 6.4924493 7.967666 11.149403 9.272338 6.966778 3.95985 2.3002303 -0.031977255 -3.8596547 -4.5471654 -3.4077094 -4.0845613 -4.115473 -3.5921116 -3.1486938 -1.8951854 -0.7013678 -0.652336 0.30804753 0.90922 1.596731 2.039083 2.1073012 2.5677733 2.2501328 1.7747376 1.3291879 1.3803514 1.2193995 0.85592455 0.20252262 0.12151357 0.1257772 0.12257948 -0.13004084 -0.22490668 -0.06395451 0.078877226 0.08420677 -0.14283174 -0.09379995 -0.018120443 0.058624968 -0.13750221 0.02131817 0.12897493 0.06395451 0.010659085 0.17267717 0.163084 
];
Gyro_y=[-1.084029 -0.9731744 -1.1277313 -0.9305382 -0.58944744 -0.10126131 0.036240887 -0.3251021 -0.617161 -0.7493337 -0.77704734 -0.5297565 -0.46153837 -0.86232 -0.9273404 -0.7205542 -0.9475927 -0.16734761 0.23769759 0.3911884 0.17374308 -0.04263634 -0.19292943 -0.10126131 -0.008527268 0.09912949 0.0149227185 -0.009593176 0.3634748 0.41144067 0.3783975 -0.09806357 -0.1257772 -0.1129863 -0.036240887 -0.07781132 -0.04370225 -0.1385681 -0.1886658 -0.19932489 -0.23236805 -0.24515896 -0.18227033 -0.14816129 0.039438613 -0.114052214 -0.049031787 0.04370225 -0.10126131 -0.1385681 -0.3165748 -0.58731556 -0.4029134 -0.302718 -0.2771362 -0.6310178 -0.2131817 0.107656755 -0.32190436 -0.6299519 -0.83034265 -0.8953631 -0.81435406 -0.9326699 0.06608633 -0.86232 -1.502931 -1.0051517 -3.4546094 -5.164326 -4.494936 -3.5174978 -3.1518917 -3.8905659 -3.8905659 -4.2657657 -2.6189373 -3.1497595 -1.4507015 0.14176582 1.2844198 0.051163606 -0.4242316 -4.632438 -2.1030374 -5.5384607 -5.6034803 -4.516254 -4.041925 -3.9864979 -4.062177 -3.6624615 -4.211405 -4.33505 -2.5667076 -2.492094 -3.9705093 -2.6157396 -1.3654289 -1.899449 -0.50097704 0.38692477 -2.822526 -2.7329895 -4.6686797 -5.112097 -4.296677 -5.6120086 -4.4757495 -3.691241 -4.207141 -3.7797117 -4.491739 -3.12098 -2.0817194 -2.1446078 -2.2959669 -0.8697814 -0.050097696 -0.65873146 -2.7084737 -1.5796764 -4.954343 -6.0053287 -5.1739197 -4.3702245 -6.6853786 -4.575945 -3.039971 -4.3020067 -3.8628523 -3.0218506 -1.327056 -1.3494401 1.2982767 1.6148512 0.41783616 1.3142653 1.7065195 0.38905662 0.52869064 -0.6118314 -0.32723388 0.52655876 -0.89429724 -0.78664047 -0.12684311 0.34002483 -0.19506125 -0.5723929 -0.024515893 0.31870663 -0.04796588 -0.5425474 -0.10019539 0.25368622 0.13004084 -0.21851125 0.033043165 0.13537037 0.11192039 -0.16628173 0.07034996 0.083140865 -0.17374308 -0.30378392 0.06608633 0.09699768 -0.28353164 
];
Gyro_z=[0.1758749 0.2387635 0.36667255 0.16521582 0.361343 0.48179063 0.09379995 0.02771362 0.39332023 0.114052214 0.079943135 0.025581803 0.0053295423 0.023449987 0.14602946 0.04370225 0.09273404 -0.21957715 -0.44448385 -0.8729791 -0.5841178 -0.3165748 -0.3112453 -0.3538816 -0.2856635 -0.41677022 -0.55320656 -0.5841178 -0.4924497 -0.49138382 -0.32190436 -0.15775445 -0.11085448 0.004263634 0.018120443 -0.08100905 0.09379995 0.06715223 0.04583407 -0.04583407 0.21851125 0.32723388 0.25048852 0.2387635 0.151359 0.2920589 0.16947946 0.1620181 0.1129863 0.2739385 0.3155089 0.38159522 0.4391543 0.53508604 0.38585886 0.34748617 0.44981337 0.523361 0.3879907 0.66192925 1.1479834 2.1382124 2.8715575 1.5178536 0.19932489 -1.2396516 -3.6709888 -7.0723033 -7.4443054 -7.243914 -6.780244 -6.4519434 -5.4340014 -3.1412323 0.09273404 2.515544 7.5274463 8.218155 9.426894 10.421387 9.371468 6.5617323 3.6049025 0.80049723 -4.902113 -7.5338416 -8.708472 -8.410018 -6.9998207 -5.6695676 -4.1527796 -0.19079761 1.0584471 2.0710602 3.6880436 4.8477516 6.2973876 7.921832 9.200921 9.845798 7.200212 4.7123814 -0.105524935 -5.189908 -8.580564 -9.997156 -8.995203 -7.4976 -5.5000877 -3.5942433 -1.2599038 0.4636702 4.2007456 6.287794 8.236275 9.3469515 10.15491 10.830697 9.529222 6.620358 4.7326336 0.652336 -4.6526904 -7.697991 -10.362762 -10.976726 -9.731745 -6.886835 -5.0140333 -0.9625154 2.3812394 3.0719483 3.7658544 4.5556927 4.6963925 4.14745 3.6656594 3.3863914 3.1732094 2.923787 2.2064307 1.480547 1.2609698 0.7418723 -0.09379995 -0.2387635 -0.2227749 -0.26327938 -0.29632258 -0.103393115 0.109788574 0.13430446 0.015988627 0.06928405 0.13537037 0.11192039 -0.060756784 -0.12044766 -0.058624968 0.0628886 -0.019186351 -0.23343396 0.017054535 -0.115118116 -0.19932489 -0.029845437 0.1620181 0.009593176 -0.09593176 
];
Gravity_x=[4.603598 4.4906406 4.399591 4.3065486 4.2114134 4.250259 8.882305 8.886022 9.041382 9.122144 9.288307 9.352167 9.393035 9.438124 9.503982 9.651574 9.689823 9.719462 9.714816 9.684029 9.6473675 9.626518 9.620657 9.617524 9.60465 9.591659 9.567989 9.538154 9.498964 9.453074 9.407039 9.379793 9.37461 9.37453 9.379498 9.381367 9.393195 9.402574 9.414496 9.422218 9.434848 9.46045 9.488845 9.510005 9.524243 9.530506 9.544687 9.549892 9.556288 9.565831 9.589384 9.620309 9.654602 9.683014 9.709316 9.729262 9.748203 9.762899 9.782695 9.793135 9.803731 9.801825 9.747051 9.474328 9.376983 9.376128 9.553206 9.776678 9.671328 8.9608135 7.6121283 5.9330764 4.1295958 2.6482866 1.7968825 1.788589 4.668798 6.5843415 8.297709 9.41121 9.63736 8.20788 7.4037237 7.21366 8.342219 8.756738 8.719092 7.6855307 6.0925193 4.5882816 3.3614893 2.7390096 3.0644546 3.8265274 4.824464 5.996045 7.282608 8.505625 9.143693 9.013533 6.7831736 5.669066 5.081621 6.7525992 7.227267 7.0031314 5.840573 4.176434 2.6352992 1.5742841 1.2033201 1.4287438 3.4422271 5.1155686 6.6458817 7.784312 8.308049 7.910026 6.586187 5.0664783 4.15464 4.180424 4.8167133 5.9804277 6.2263117 5.0194306 3.0298598 1.3209325 0.16800708 -0.28760976 0.44517478 1.7167121 2.8504527 3.7253475 4.7437773 4.483941 4.2270136 4.0484986 3.5301452 3.144447 2.9786007 2.8758838 3.039862 2.9975364 2.962882 3.192414 3.3458533 3.318976 3.2749653 3.3512936 3.4719849 3.4414458 3.3817618 3.4398222 3.5356307 3.5280955 3.4764612 3.5138545 3.4847507 3.4531813 3.4379652 3.4356506 3.413165 3.393187 3.4511504 3.5033305 3.4845407 3.4974282 3.5898452 
];
Gravity_y=[7.254045 7.2323833 7.209449 7.214208 7.2130156 7.2253227 1.3959584 1.3601279 1.2609911 1.1076944 0.9018582 0.8557733 0.84019583 0.83377254 0.80913407 0.6211869 0.5938281 0.58392507 0.6535124 0.8245264 1.0476062 1.1723973 1.2459166 1.3413322 1.4273046 1.5112561 1.6343038 1.7991298 1.9716146 2.101229 2.2082777 2.2726657 2.3125 2.3291435 2.317224 2.3175254 2.3197148 2.2961981 2.2789335 2.27694 2.2660046 2.1979082 2.1098258 2.039291 1.9786526 1.9347534 1.8700509 1.8328178 1.7941902 1.7540983 1.66934 1.5744041 1.458545 1.3159726 1.1908238 1.0902002 0.9828127 0.8402642 0.5724892 0.4317723 0.2185916 -0.25572088 -1.0123159 -2.4153311 -2.798629 -2.8652778 -2.211222 -0.69680387 1.4100982 3.4234498 5.2269173 6.854259 8.159274 9.007665 9.471384 9.6127615 8.5426 7.0604362 4.9441648 2.250498 -0.6821036 -4.5713134 -5.307819 -4.837911 -1.2179586 1.1578677 3.7161846 6.010725 7.676223 8.648514 9.160161 9.266417 8.9526615 8.381624 7.5617657 6.330925 4.7101383 2.7302442 0.38917527 -2.2463617 -6.02928 -6.339701 -5.505021 -0.4241051 2.3247945 4.9380817 7.1334147 8.550455 9.195643 9.336035 9.214416 8.92521 7.426384 6.048978 4.217526 1.7587013 -0.9409901 -3.4939978 -5.3882766 -5.995429 -5.592488 -3.8509176 -1.0235926 1.9943589 4.8136597 7.130582 8.640052 9.065926 8.684622 8.02228 7.3812866 6.4425826 5.337415 4.106252 1.4546492 0.41342893 -0.2693517 -0.820125 -1.07928 -1.0413635 -0.760808 -0.37124437 0.14260715 0.74635494 1.2973458 1.758413 2.1445813 2.5286374 2.834038 3.0250552 3.070994 3.090307 3.116685 3.137539 3.077425 3.0145278 3.0331264 3.0530653 3.0160925 2.9986367 3.011252 2.9983025 2.9755335 3.000274 3.0400205 3.035272 3.0402954 3.0886102 3.126488 
];
Gravity_z=[-4.7282224 -4.867972 -4.983757 -5.0575876 -5.138754 -5.089242 3.9148843 3.9190607 3.5824106 3.4248948 3.0140288 2.8240075 2.6898549 2.5292315 2.2781577 1.6222283 1.3874743 1.1668187 1.1686071 1.307728 1.4146391 1.4580804 1.4356256 1.369096 1.3725506 1.3735291 1.3975081 1.3989745 1.4327531 1.5474503 1.6737732 1.7392025 1.714464 1.6922241 1.6810291 1.6701427 1.5991234 1.5778072 1.531041 1.4858361 1.4209943 1.356271 1.2964611 1.2535858 1.2426217 1.2635504 1.2538836 1.269139 1.2761843 1.2603043 1.1947387 1.0683131 0.91196865 0.8232976 0.693895 0.5685627 0.42071867 0.38748336 0.3761632 0.28012246 0.09723784 -0.17098318 -0.37495473 -0.757393 -0.640524 -0.22085428 -0.1308578 -0.31843787 -0.80461687 -2.0381815 -3.302305 -3.7400718 -3.5416138 -2.831773 -1.798468 -0.7524363 1.1818191 1.7225189 1.6951786 1.5920892 1.6811972 2.8114374 3.6307487 4.5528135 5.0094247 4.2601957 2.5174947 0.987005 0.35661477 0.5668103 0.98091185 1.6738394 2.5747447 3.3580408 3.964169 4.487448 4.576964 4.0460424 3.5230412 3.143319 3.7157395 4.882649 6.3278966 7.0987964 6.2074423 4.768841 3.3425245 2.370126 2.160025 2.5554733 3.133201 3.803908 5.40095 5.780242 5.8493705 5.6992855 5.12457 4.625347 4.8743205 5.8784366 6.901698 7.9915485 8.480678 7.5118165 5.8508196 4.4866977 3.5128114 3.4977868 4.5518665 5.6330013 6.441181 7.191412 7.717337 8.088934 8.458779 8.7117 8.844784 8.894235 9.08535 9.230297 9.31233 9.368128 9.322514 9.307423 9.257894 9.104219 8.96529 8.874727 8.798477 8.705645 8.642031 8.64736 8.661428 8.630981 8.6138935 8.639187 8.653597 8.6314535 8.656216 8.67491 8.676584 8.681986 8.698672 8.69799 8.661306 8.642002 8.64783 8.625477 8.573708 
];

trim = 1:length(LinearAcc_x);
w = [Gyro_x',Gyro_y',Gyro_z'];
m =  zeros(length(trim),3);
g = [Gravity_x', Gravity_y', Gravity_z'];
a = [LinearAcc_x', LinearAcc_y', LinearAcc_z'];
t = (trim-1).*0.01;


%{
filename = "logData/Star.csv";
temp = real(csvread(filename));
trim = 1:length(temp);
a = temp(trim,1:3);
w = temp(trim,4:6);
m = temp(trim,7:9);
g = temp(trim,10:12);
t = temp(trim, 13);
%}

q = [ones(length(trim), 1), zeros(length(trim),3)];
v = zeros(length(trim),3);
p = zeros(length(trim),3);
Ea = zeros(length(trim),3);
w_b = [0, 0, 0];

% System Constants
wME = pi * 3 / 180;
wMD = pi * 0.2 / 180;
beta = sqrt(3/4) * wME;
zeta = sqrt(3/4) * wMD;
threshold = 10;

% Pre-Processing Block
[b_coef a_coef] = butter(1, (2*5)/100, 'low');
g_f = filtfilt(b_coef,a_coef,g);

a_mag = sqrt(a(:,1).*a(:,1) + a(:,2).*a(:,2) + a(:,3).*a(:,3));
[b_coef, a_coef] = butter(1, (2*0.001)/(100), 'high');
a_mag = filtfilt(b_coef, a_coef, a_mag);
a_mag = abs(a_mag);
[b_coef, a_coef] = butter(1, (2*5)/(100), 'low');
a_mag = filtfilt(b_coef, a_coef, a_mag);
a_mag = abs(a_mag);
stationary = a_mag < threshold;

%for i = 1:2000
%  [q(1,:) w_b] = GDFilter(q(1,:), mean(g_f(1:100,:)), [0,0,0], mean(m(1:100,:)), 0.01, beta, zeta, w_b);
%end

for i = 1:length(t)
  if i == 1
    w(i,:) = [0, 0, 0];
  else
    dt = 0.01;
    [q(i,:), w_b] = GDFilter(q(i-1,:), g_f(i,:), w(i,:), m(i,:), dt, beta, zeta, w_b);
  end
  Ea(i,:) = quaternProd(quaternProd(q(i,:),[0 a(i,:)]), quaternConj(q(i,:)))(2:4);
end

for i = 2:length(t)
   v(i,:) = v(i-1,:) + (Ea(i,:).*dt);
   if(stationary(i) == 1)
     v(i,:) = [0 0 0];
   end
end

velDrift = zeros(size(v));
stationaryStart = find([0; diff(stationary)] == -1);
stationaryEnd = find([0; diff(stationary)] == 1);
for i = 1:numel(stationaryEnd)
    driftRate = v(stationaryEnd(i)-1, :) / (stationaryEnd(i) - stationaryStart(i));
    enum = 1:(stationaryEnd(i) - stationaryStart(i));
    drift = [enum'*driftRate(1) enum'*driftRate(2) enum'*driftRate(3)];
    velDrift(stationaryStart(i):stationaryEnd(i)-1, :) = drift;
end

%v(:,1:2) = v(:,1:2) - velDrift(:,1:2);
v = v- velDrift;
for i = 2:length(t)
  v_abs(i) = norm(v(i,:));
  p(i,:) = p(i-1,:) + v(i,:).*dt;
end
[b_coef, a_coef] = butter(1, (2*0.1)/100, 'high');
p = filtfilt(b_coef, a_coef, p);
%p(:,3) = filtfilt(b_coef, a_coef, p(:,3));


figure();
title("MC B Stairs");
xlabel("x (m)");
ylabel("y (m)");
zlabel("z (m)");
grid on;

v_abs = v_abs*3.6;
surface('XData',[p(:,1) p(:,1)],'YData',[p(:,2) p(:,2)],
        'ZData',[p(:,3) p(:,3)],'CData',[v_abs v_abs],
        'FaceColor','none','EdgeColor','flat','Marker','none',
        'LineWidth', 2.5);
axis equal;
%colorbar;
